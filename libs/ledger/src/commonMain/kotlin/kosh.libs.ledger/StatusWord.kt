package kosh.libs.ledger

enum class StatusWord(val code: Int) {
    ACCESS_CONDITION_NOT_FULFILLED(0x9804),
    ALGORITHM_NOT_SUPPORTED(0x9484),
    CLA_NOT_SUPPORTED(0x6e00),
    CODE_BLOCKED(0x9840),
    CODE_NOT_INITIALIZED(0x9802),
    COMMAND_INCOMPATIBLE_FILE_STRUCTURE(0x6981),
    CONDITIONS_OF_USE_NOT_SATISFIED(0x6985),
    CONTRADICTION_INVALIDATION(0x9810),
    CONTRADICTION_SECRET_CODE_STATUS(0x9808),
    DEVICE_IN_RECOVERY_MODE(0x662f),
    CUSTOM_IMAGE_EMPTY(0x662e),
    FILE_ALREADY_EXISTS(0x6a89),
    FILE_NOT_FOUND(0x9404),
    GP_AUTH_FAILED(0x6300),
    HALTED(0x6faa),
    INCONSISTENT_FILE(0x9408),
    ERROR_NO_INFO(0x6a00),
    INCORRECT_DATA(0x6a80),
    INCORRECT_LENGTH(0x6700),
    INCORRECT_P1_P2(0x6b00),
    INS_NOT_SUPPORTED(0x6d00),
    DEVICE_NOT_ONBOARDED(0x6d07),
    DEVICE_NOT_ONBOARDED_2(0x6611),
    PLUGIN_NOT_PRESENT(0x6984),
    INVALID_KCV(0x9485),
    INVALID_OFFSET(0x9402),
    LICENSING(0x6f42),
    LOCKED_DEVICE(0x5515),
    MAX_VALUE_REACHED(0x9850),
    MEMORY_PROBLEM(0x9240),
    MISSING_CRITICAL_PARAMETER(0x6800),
    NO_EF_SELECTED(0x9400),
    NOT_ENOUGH_MEMORY_SPACE(0x6a84),
    OK(0x9000),
    PIN_REMAINING_ATTEMPTS(0x63c0),
    REFERENCED_DATA_NOT_FOUND(0x6a88),
    SECURITY_STATUS_NOT_SATISFIED(0x6982),
    TECHNICAL_PROBLEM(0x6f00),
    UNKNOWN_APDU(0x6d02),
    USER_REFUSED_ON_DEVICE(0x5501),
    NOT_ENOUGH_SPACE(0x5102),
    APP_NOT_FOUND_OR_INVALID_CONTEXT(0x5123),
    INVALID_APP_NAME_LENGTH(0x670a),
    GEN_AES_KEY_FAILED(0x5419),
    INTERNAL_CRYPTO_OPERATION_FAILED(0x541a),
    INTERNAL_COMPUTE_AES_CMAC_FAILED(0x541b),
    ENCRYPT_APP_STORAGE_FAILED(0x541c),
    INVALID_BACKUP_STATE(0x6642),
    PIN_NOT_SET(0x5502),
    INVALID_BACKUP_LENGTH(0x6733),
    INVALID_RESTORE_STATE(0x6643),
    INVALID_CHUNK_LENGTH(0x6734),
    INVALID_BACKUP_HEADER(0x684a),
}

fun StatusWord.expectSuccess(): Unit = when (this) {
    StatusWord.OK -> Unit
    StatusWord.CONDITIONS_OF_USE_NOT_SATISFIED -> throw LedgerManager.ActionRejectedException()
    StatusWord.ACCESS_CONDITION_NOT_FULFILLED,
    StatusWord.ALGORITHM_NOT_SUPPORTED,
    StatusWord.CLA_NOT_SUPPORTED,
    StatusWord.CODE_BLOCKED,
    StatusWord.CODE_NOT_INITIALIZED,
    StatusWord.COMMAND_INCOMPATIBLE_FILE_STRUCTURE,
    StatusWord.CONTRADICTION_INVALIDATION,
    StatusWord.CONTRADICTION_SECRET_CODE_STATUS,
    StatusWord.DEVICE_IN_RECOVERY_MODE,
    StatusWord.CUSTOM_IMAGE_EMPTY,
    StatusWord.FILE_ALREADY_EXISTS,
    StatusWord.FILE_NOT_FOUND,
    StatusWord.GP_AUTH_FAILED,
    StatusWord.HALTED,
    StatusWord.INCONSISTENT_FILE,
    StatusWord.ERROR_NO_INFO,
    StatusWord.INCORRECT_DATA,
    StatusWord.INCORRECT_LENGTH,
    StatusWord.INCORRECT_P1_P2,
    StatusWord.INS_NOT_SUPPORTED,
    StatusWord.DEVICE_NOT_ONBOARDED,
    StatusWord.DEVICE_NOT_ONBOARDED_2,
    StatusWord.PLUGIN_NOT_PRESENT,
    StatusWord.INVALID_KCV,
    StatusWord.INVALID_OFFSET,
    StatusWord.LICENSING,
    StatusWord.LOCKED_DEVICE,
    StatusWord.MAX_VALUE_REACHED,
    StatusWord.MEMORY_PROBLEM,
    StatusWord.MISSING_CRITICAL_PARAMETER,
    StatusWord.NO_EF_SELECTED,
    StatusWord.NOT_ENOUGH_MEMORY_SPACE,
    StatusWord.PIN_REMAINING_ATTEMPTS,
    StatusWord.REFERENCED_DATA_NOT_FOUND,
    StatusWord.SECURITY_STATUS_NOT_SATISFIED,
    StatusWord.TECHNICAL_PROBLEM,
    StatusWord.UNKNOWN_APDU,
    StatusWord.USER_REFUSED_ON_DEVICE,
    StatusWord.NOT_ENOUGH_SPACE,
    StatusWord.APP_NOT_FOUND_OR_INVALID_CONTEXT,
    StatusWord.INVALID_APP_NAME_LENGTH,
    StatusWord.GEN_AES_KEY_FAILED,
    StatusWord.INTERNAL_CRYPTO_OPERATION_FAILED,
    StatusWord.INTERNAL_COMPUTE_AES_CMAC_FAILED,
    StatusWord.ENCRYPT_APP_STORAGE_FAILED,
    StatusWord.INVALID_BACKUP_STATE,
    StatusWord.PIN_NOT_SET,
    StatusWord.INVALID_BACKUP_LENGTH,
    StatusWord.INVALID_RESTORE_STATE,
    StatusWord.INVALID_CHUNK_LENGTH,
    StatusWord.INVALID_BACKUP_HEADER,
        -> error("Expected OK, but got $this")
}
